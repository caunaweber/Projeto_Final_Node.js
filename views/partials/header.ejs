<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<nav class="navbar navbar-expand-lg" style="background-color: #6c63ff;">
  <div class="container-fluid px-4">
    <a class="navbar-brand text-white" href="/dashboard">Plataforma de Feedback</a>
    <div class="ms-auto d-flex align-items-center gap-3">
      <span class="text-light" id="greeting"></span>

      <script>
        const userName = "<%= user.username %>";
        const hour = new Date().getHours();
        let greeting = "Olá";

        if (hour < 12) greeting = "Bom dia";
        else if (hour < 18) greeting = "Boa tarde";
        else greeting = "Boa noite";

        document.getElementById('greeting').textContent = `${greeting}, ${userName}!`;
      </script>

      <% if (user && user.role==='admin' && currentUrl !=='/produtos' ) { %>
        <a href="/produtos" class="btn btn-outline-light">Gerenciar Produtos</a>
        <% } %>

          <a href="#" id="logoutBtn" class="btn btn-light text-dark">Logout</a>

    </div>
  </div>
</nav>

<script>
  document.getElementById('logoutBtn').addEventListener('click', function (e) {
    e.preventDefault();

    Swal.fire({
      title: 'Tem certeza?',
      text: "Você será desconectado da plataforma.",
      icon: 'warning',
      showCancelButton: true,
      confirmButtonColor: '#6c63ff',
      cancelButtonColor: '#d33',
      confirmButtonText: 'Sim, sair',
      cancelButtonText: 'Cancelar'
    }).then((result) => {
      if (result.isConfirmed) {
        window.location.href = '/logout';
      }
    });
  });
</script>